@using CYESW.Models
@{
    Layout = null;
    UserInfo user = Session["user"] as UserInfo;
}
@model List<WebOut>

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>LunBo</title>
    <link href="~/layui/css/layui.css" rel="stylesheet" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>

    <script type="text/javascript">
        var date = new Date().getTime();
        document.write("<link rel='stylesheet' href='../Content/mycss_back.css'?v=" + date + "'>");
    </script>
</head>
<body>
    <div>
        <div class="homeback">
            <h2>广告推广（站外）</h2>
            <br />
            <div>
                <a href="" class="layui-btn layui-btn-normal" data-toggle="modal" data-target="#exampleModal">新增</a>
            </div>
            <table class="layui-table layui-table-hover layui-table-header">
                <tr>
                    <th>广告图</th>
                    <th>广告标题</th>
                    <th>文本介绍</th>
                    <th>链接地址</th>
                    <th>添加时间</th>
                    <th>备注</th>
                </tr>
                @foreach (var item in Model)
                {
                    <tr>
                        <td><img src="~/images/webout/@item.images" /></td>
                        <td>@item.Name</td>
                        <td>@item.Info</td>
                        <td><a href="@item.a_1">@item.a_1</a></td>
                        <td>@item.addtime</td>
                        <td>@item.type_1</td>
                        <td><a href="#" class="layui-btn" onclick="Selset_WebOut(@item.WebOutId)"  data-toggle="modal" data-target="#exampleModa2">修改</a><a href="#" onclick="Delete_Webout(@item.WebOutId)" class="layui-btn layui-btn-danger">删除</a></td>
                    </tr>
                }


            </table>
        </div>
    </div>

    <!-- Modal 修改-->
    <div class="modal fade" id="exampleModa2" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">修改广告推广（站外）</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/BackgRound/Update_WebOut" id="form2" class="form_addres" enctype="multipart/form-data">
                        <table class="table">
                            <tr>
                                <td>
                                    广告图(不上传不修改):
                                </td>
                                <td>
                                    <input type="file" name="images"  value="" />
                                    <input type="hidden" name="WebOutId" id="WebOutId" value="" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    广告标题：
                                </td>
                                <td>
                                    <input type="text" name="Name" id="Name_1" value="" class="form-control" placeholder=" 请输入广告标题" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    文本介绍：
                                </td>
                                <td>
                                    <input type="text" name="Info" id="Info_1" value="" class="form-control" placeholder=" 请输入文本介绍" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    跳转地址：
                                </td>
                                <td>
                                    <input type="text" name="a_1" id="a_1_1" value="" class="form-control" placeholder=" 请输入跳转地址" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    备注：
                                </td>
                                <td>
                                    <input type="text" name="type_1" id="type_1_1" value="" class="form-control" placeholder=" 请输入备注" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                                </td>
                                <td>
                                    <button type="submit" class="btn btn-primary">保存</button>
                                </td>
                            </tr>
                        </table>
                    </form>

                </div>
            </div>
        </div>
    </div>

    <!-- Modal 新增-->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">新增广告推广（站外）</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/BackgRound/Add_Webout" id="form1" class="form_addres" enctype="multipart/form-data">
                        <table class="table">
                            <tr>
                                <td>
                                    广告图:
                                </td>
                                <td>
                                    <input type="file" name="Photos" id="Photos" value="" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    广告标题：
                                </td>
                                <td>
                                    <input type="text" name="Name" id="Name" value="" class="form-control" placeholder=" 请输入广告标题" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    文本介绍：
                                </td>
                                <td>
                                    <input type="text" name="Info" id="Info" value="" class="form-control" placeholder=" 请输入文本介绍" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    跳转地址：
                                </td>
                                <td>
                                    <input type="text" name="a_1" id="a_1" value="" class="form-control" placeholder=" 请输入跳转地址" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    备注：
                                </td>
                                <td>
                                    <input type="text" name="type_1" value="" class="form-control" placeholder=" 请输入备注" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                                </td>
                                <td>
                                    <button type="submit" class="btn btn-primary">保存</button>
                                </td>
                            </tr>
                        </table>
                    </form>

                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function Selset_WebOut(id) {
            $.ajax({
                type: "post",
                data: { "id": id },
                async: false,//不异步请求
                url: "/BackgRound/Selset_WebOut",
                success: function (data) {
                    var msg = jQuery.parseJSON(data);//那以后每次用的收都将goods转化为这个形式
                    console.log(msg);
                    $('#Name_1').val(msg.Name);
                    $('#Info_1').val(msg.Info);
                    $('#a_1_1').val(msg.a_1);
                    $('#type_1_1').val(msg.type_1); 
                    $('#WebOutId').val(msg.WebOutId);
                },
                error: function (e) {
                    alert("失败了？？：" + e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            })
        }

        function Delete_Webout(id) {
            if (confirm('你确定要删除吗？')) {
                $.ajax({
                type: "post",
                data: { "id": id },
                async: false,//不异步请求
                url: "/BackgRound/Delete_Webout",
                success: function (data) {
                    alert(data);
                    location.reload();
                },
                error: function (e) {
                    alert("失败了？？：" + e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            })
            }
            
        }
    </script>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    <script src="~/Scripts/valuedate.js"></script>
</body>

</html>
