
@{
    ViewBag.Title = "Login";
}
<style>
    .cotn_principal {
        position: relative;
        height: 600px;
        width: 100%;
        margin: 0px auto;
        border-radius: 15px;
        /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#cfd8dc+0,607d8b+100,b0bec5+100 */
        background: #aac4bc; /* Old browsers */
        background: -moz-linear-gradient(-45deg, #aac4bc 0%, #eca8a8 100%, #eed5a9 100%); /* FF3.6-15 */
        background: -webkit-linear-gradient(-45deg, #aac4bc 0%,#eca8a8 100%,#eed5a9 100%); /* Chrome10-25,Safari5.1-6 */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#cfd8dc', endColorstr='#b0bec5',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
        transition:all 1s 1s;
    }

    .cotn_principal_deuflt {
        background: linear-gradient(135deg, #fcc3077a 0%,#41b34996 100%,#41b34996 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+  */
    }
    .cotn_principal_login {
        background: linear-gradient(135deg, #f8bc317a 0%,#cc163a59 100%,#eed5a9 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        
    }
    .cotn_principal_rejset {
        background: linear-gradient(135deg, #66c18cbd 0%,#51c4d385 100%,#eed5a9 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+  */
    }
</style>


<div class="cotn_principal cotn_principal_deuflt" id="bgcolors">
    <div class="cont_centrar" style="position:relative;height:600px;margin-top:50px;">
        <div class="cont_login">
            <div class="cont_info_log_sign_up">
                <div class="col_md_login">
                    <div class="cont_ba_opcitiy">
                        <h2>登录</h2>
                        <p>欢迎登陆！朝阳二手网，二手买卖网</p>
                        <button class="btn_login" onClick="cambiar_login()">登录</button>
                    </div>
                </div>
                <div class="col_md_sign_up">
                    <div class="cont_ba_opcitiy">
                        <h2>注册</h2>
                        <p>欢迎注册！朝阳二手网，二手买卖网</p>
                        <button class="btn_sign_up" onClick="cambiar_sign_up()">注册</button>
                    </div>
                </div>
            </div>
            <div class="cont_back_info">
                <div class="cont_img_back_grey">  </div>
            </div>
            <div class="cont_forms">
                <div class="cont_img_back_">  </div>
                <form action="/Home/Login" method="post" id="form2">
                    <div class="cont_form_login">
                        <a href="#" onClick="ocultar_login_sign_up()">
                            <svg t="1592291901105" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3707" width="16" height="16"><path d="M72.145455 660.154182H302.545455L49.338182 913.221818a47.941818 47.941818 0 1 0 67.863273 67.863273l257.11709-257.117091v228.445091a47.988364 47.988364 0 0 0 96.023273 0v-340.386909c0-26.530909-21.504-47.988364-48.034909-47.988364H72.145455a47.988364 47.988364 0 0 0 0 96.116364zM602.298182 459.403636h350.208a47.988364 47.988364 0 0 0 0-95.976727h-230.306909l253.207272-253.207273A47.941818 47.941818 0 1 0 907.543273 42.356364l-257.210182 257.117091V71.074909a47.988364 47.988364 0 0 0-96.023273 0v340.340364c0 26.530909 21.504 47.988364 48.034909 47.988363z" fill="#efb336" p-id="3708"></path></svg>
                        </a>
                        <h2>登录</h2>
                        <input type="text" placeholder="邮箱" id="UserEmile" name="UserEmile" value="@ViewBag.UserEmile" />
                        <input type="password" placeholder="密码" id="UserPwd" name="UserPwd" />
                        <input type="submit" value="登录" class=" btn_login" style="font-size:18px;text-align:center;color:white" />
                    </div>
                </form>
                <form action="/Home/Register" method="post" id="form1">
                    <div class="cont_form_sign_up">
                        <a href="#" onClick="ocultar_login_sign_up()">
                            <svg t="1592291901105" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3707" width="16" height="16"><path d="M72.145455 660.154182H302.545455L49.338182 913.221818a47.941818 47.941818 0 1 0 67.863273 67.863273l257.11709-257.117091v228.445091a47.988364 47.988364 0 0 0 96.023273 0v-340.386909c0-26.530909-21.504-47.988364-48.034909-47.988364H72.145455a47.988364 47.988364 0 0 0 0 96.116364zM602.298182 459.403636h350.208a47.988364 47.988364 0 0 0 0-95.976727h-230.306909l253.207272-253.207273A47.941818 47.941818 0 1 0 907.543273 42.356364l-257.210182 257.117091V71.074909a47.988364 47.988364 0 0 0-96.023273 0v340.340364c0 26.530909 21.504 47.988364 48.034909 47.988363z" fill="#efb336" p-id="3708"></path></svg>
                        </a>
                        <h2>注册</h2>
                        <input type="text" placeholder="邮箱" id="UserEmile1" name="UserEmile1" />
                        <input type="password" placeholder="密码" id="UserPwd1" name="UserPwd1" />
                        <div class="zixie_1 row">
                            <div class="col-lg-7">
                                <input class="form-control" type="text"
                                       placeholder="验证码" required="required"
                                       name="validateCode" id="validateCode" />
                            </div>
                            <div class=" col-lg-3">
                                <img src="~/Handler/ValidateCodeHandler.ashx?id=1" onclick="this.src=this.src+1" />
                            </div>
                        </div>
                        <div class="zixie_1 row">
                            <div class="col-lg-7">
                                <input class="form-control" type="text"
                                       placeholder="邮箱验证码" required="required"
                                       name="yanzhen" id="yanzhen" value="@ViewBag.UserEmile1" />
                            </div>
                            <div class=" col-lg-3">
                                <input type="button" class="btn btn-primary" style="height:32px;width:100px;font-size:12px;text-align:center" value="发送验证码" onclick="sendCode(this)" />
                            </div>
                        </div>
                        <input type="submit" value="注册" class="btn_sign_up" style="font-size:18px;text-align:center;color:white" />
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/login/index.js?v=1.1"></script>
<script type="text/javascript">
    //ajax发送邮件
    var zhibiao1 = 0, zhibiao2 = 0;//是否发送邮箱，是否通过验证
    function GetYZ() {
        validateCode()//发送邮件前，先验证静态验证码是否正确
        if (zhibiao2 == 0) {
            return
        }
            console.log($('#UserEmile1').val().toString());
            if ($('#UserEmile1').val() != null && $('#UserEmile1').val() != "") {
                $.ajax({
                    type: "POST",
                    url: "/Home/GetYZ",
                     async: false,//不异步请求
                    data: { "UserEmile": $('#UserEmile1').val().toString() },/*参数*/
                    //dataType: Text,/*参数类型*/
                    success: function (result) {
                        alert(result.res);
                        console.log("隐藏信息:" + result.yc + "    时间:" + result.datetime)
                        if (result.res="发送成功！d=====(￣▽￣*)b (请前往邮件查看验证码)") {
                            zhibiao1 = 1;
                        }
                    }
                })
            } else {
                alert('请先填写邮箱!');
            }
    }
    //验证验证码
    function validateCode() {
        var validate = $('#validateCode').val().toString();
        if ($('#validateCode').val() != null && $('#validateCode').val() != "") {
            $.ajax({
                type: "get",
                url: "/Home/validateCode",
                async: false,//不异步请求
                data: { "validateCode": $('#validateCode').val().toString() },/*参数*/
                //dataType: Text,/*参数类型*/
                success: function (result) {
                    if (result.res == "ok") {
                        console.log(validate+":验证码通过;时间" + result.datetime);
                        zhibiao2 = 1;
                    } else {
                        alert('验证码错误!');
                    }
                }
            })
        } else {
            alert('请先填写验证码!');
        }
    }


    //按钮禁用
    var clock = '';
    var nums = 60;
    var btn;
    function sendCode(thisBtn) {
        GetYZ();
        if (zhibiao1 == 0) {
            return
        }
        btn = thisBtn;
        btn.disabled = true; //将按钮置为不可点击
        btn.value = nums + '秒后可用';
        clock = setInterval(doLoop, 1000); //一秒执行一次


    }
    function doLoop() {
        nums--;
        if (nums > 0) {
            btn.value = nums + '秒后可用';
        } else {
            clearInterval(clock); //清除js定时器
            btn.disabled = false;
            btn.value = '发送验证码';
            nums = 60; //重置时间
        }
    }
</script>




